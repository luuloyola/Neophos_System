/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package paneles;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import logico.Manager_OrdenCompra;
import logico.Orden_Compra;
import logico.Renglon_Compra;

/**
 *
 * @author Usuario
 */
public class ConsultarOrdenDeCompra extends javax.swing.JPanel {
  
    private DefaultTableModel modelo;
    private List<Orden_Compra> ordenes = new ArrayList<>();
    private Orden_Compra orden = new Orden_Compra();
    
    public ConsultarOrdenDeCompra() throws Exception {
        initComponents();
        
        modelo = (DefaultTableModel) tablaInicio.getModel();
        
        ordenes = Manager_OrdenCompra.getInstance().consultarTodasLasOrdenes();
        
        for(int i = 0; i<ordenes.size(); i++){
            orden = ordenes.get(i);
            modelo.addRow(new Object[] {orden.getFechaPedido(), orden.getPrecioTotal(), orden.getProveedor()});
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        contenedor = new javax.swing.JPanel();
        inicio = new javax.swing.JPanel();
        Titulo1 = new javax.swing.JLabel();
        Separador7 = new javax.swing.JLabel();
        aceptarButton1 = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        tablaInicio = new javax.swing.JTable();
        volverButton1 = new javax.swing.JButton();
        mesas1 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        mesas = new javax.swing.JLabel();
        muestra = new javax.swing.JPanel();
        Titulo2 = new javax.swing.JLabel();
        Separador8 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        tablaRenglones = new javax.swing.JTable();
        volverButton2 = new javax.swing.JButton();
        infoOrdenLabel1 = new javax.swing.JLabel();
        FechaPLabel1 = new javax.swing.JLabel();
        PrecioLabel1 = new javax.swing.JLabel();
        IDProveedorLabel1 = new javax.swing.JLabel();
        infoRenglonesLabel1 = new javax.swing.JLabel();
        FechaPLabel3 = new javax.swing.JLabel();
        PrecioLabel3 = new javax.swing.JLabel();
        IDProveedorLabel3 = new javax.swing.JLabel();
        mesas2 = new javax.swing.JLabel();

        contenedor.setBackground(new java.awt.Color(204, 204, 204));
        contenedor.setMaximumSize(new java.awt.Dimension(1042, 619));
        contenedor.setLayout(new java.awt.CardLayout());

        inicio.setBackground(new java.awt.Color(227, 227, 218));
        inicio.setMaximumSize(new java.awt.Dimension(1042, 619));
        inicio.setPreferredSize(new java.awt.Dimension(1065, 619));

        Titulo1.setFont(new java.awt.Font("Microsoft YaHei", 1, 21)); // NOI18N
        Titulo1.setForeground(new java.awt.Color(97, 34, 34));
        Titulo1.setText("CONSULTAR ORDEN DE COMPRA");

        Separador7.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        Separador7.setForeground(new java.awt.Color(97, 34, 34));
        Separador7.setText("__________________________________________________________________________________________________________________________________________________________________________________________________");

        aceptarButton1.setText("Aceptar");
        aceptarButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                aceptarButton1ActionPerformed(evt);
            }
        });

        tablaInicio.setFont(new java.awt.Font("Microsoft YaHei", 0, 12)); // NOI18N
        tablaInicio.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Fecha Pedido", "Precio Total", "Nombre Proveedor"
            }
        ));
        tablaInicio.getTableHeader().setReorderingAllowed(false);
        jScrollPane2.setViewportView(tablaInicio);

        volverButton1.setFont(new java.awt.Font("Microsoft YaHei", 0, 11)); // NOI18N
        volverButton1.setText("Cancelar");
        volverButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                volverButton1ActionPerformed(evt);
            }
        });

        jLabel3.setText("Seleccione la orden de compra que desea consultar");

        mesas.setText("              ");

        javax.swing.GroupLayout inicioLayout = new javax.swing.GroupLayout(inicio);
        inicio.setLayout(inicioLayout);
        inicioLayout.setHorizontalGroup(
            inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(inicioLayout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, inicioLayout.createSequentialGroup()
                        .addGroup(inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 966, Short.MAX_VALUE)
                            .addGroup(inicioLayout.createSequentialGroup()
                                .addGap(0, 0, Short.MAX_VALUE)
                                .addComponent(jLabel3))
                            .addGroup(inicioLayout.createSequentialGroup()
                                .addComponent(volverButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(aceptarButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(mesas1))
                    .addGroup(inicioLayout.createSequentialGroup()
                        .addGroup(inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(inicioLayout.createSequentialGroup()
                                .addGap(9, 9, 9)
                                .addComponent(Titulo1)
                                .addGap(188, 188, 188)
                                .addComponent(mesas))
                            .addComponent(Separador7))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap(74, Short.MAX_VALUE))
        );
        inicioLayout.setVerticalGroup(
            inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(inicioLayout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(Titulo1)
                    .addComponent(mesas))
                .addGap(1, 1, 1)
                .addComponent(Separador7)
                .addGroup(inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(inicioLayout.createSequentialGroup()
                        .addGap(54, 54, 54)
                        .addComponent(mesas1))
                    .addGroup(inicioLayout.createSequentialGroup()
                        .addGap(33, 33, 33)
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 348, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addComponent(jLabel3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(inicioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(aceptarButton1)
                    .addComponent(volverButton1))
                .addContainerGap(106, Short.MAX_VALUE))
        );

        mesas.setFont(new java.awt.Font("DialogInput", 1, 28));

        contenedor.add(inicio, "card2");

        muestra.setBackground(new java.awt.Color(227, 227, 218));
        muestra.setMaximumSize(new java.awt.Dimension(1042, 619));
        muestra.setPreferredSize(new java.awt.Dimension(1065, 619));

        Titulo2.setFont(new java.awt.Font("Microsoft YaHei", 1, 21)); // NOI18N
        Titulo2.setForeground(new java.awt.Color(97, 34, 34));
        Titulo2.setText("CONSULTAR ORDEN DE COMPRA");

        Separador8.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        Separador8.setForeground(new java.awt.Color(97, 34, 34));
        Separador8.setText("__________________________________________________________________________________________________________________________________________________________________________________________________");

        tablaRenglones.setFont(new java.awt.Font("Microsoft YaHei", 0, 12)); // NOI18N
        tablaRenglones.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Cantidad", "Precio ", "Producto que tiene"
            }
        ));
        tablaRenglones.getTableHeader().setReorderingAllowed(false);
        jScrollPane3.setViewportView(tablaRenglones);

        volverButton2.setFont(new java.awt.Font("Microsoft YaHei", 0, 11)); // NOI18N
        volverButton2.setText("Cancelar");
        volverButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                volverButton2ActionPerformed(evt);
            }
        });

        infoOrdenLabel1.setFont(new java.awt.Font("Microsoft YaHei", 1, 14)); // NOI18N
        infoOrdenLabel1.setForeground(new java.awt.Color(97, 34, 34));
        infoOrdenLabel1.setText("Información de la Orden de Compra consultada:");

        FechaPLabel1.setFont(new java.awt.Font("Microsoft YaHei", 1, 14)); // NOI18N
        FechaPLabel1.setForeground(new java.awt.Color(97, 34, 34));
        FechaPLabel1.setText("Fecha Pedido:");

        PrecioLabel1.setFont(new java.awt.Font("Microsoft YaHei", 1, 14)); // NOI18N
        PrecioLabel1.setForeground(new java.awt.Color(97, 34, 34));
        PrecioLabel1.setText("Precio Total:");

        IDProveedorLabel1.setFont(new java.awt.Font("Microsoft YaHei", 1, 14)); // NOI18N
        IDProveedorLabel1.setForeground(new java.awt.Color(97, 34, 34));
        IDProveedorLabel1.setText("Nombre Proveedor:");

        infoRenglonesLabel1.setFont(new java.awt.Font("Microsoft YaHei", 1, 14)); // NOI18N
        infoRenglonesLabel1.setForeground(new java.awt.Color(97, 34, 34));
        infoRenglonesLabel1.setText("Información de su/s renglon/es:");

        javax.swing.GroupLayout muestraLayout = new javax.swing.GroupLayout(muestra);
        muestra.setLayout(muestraLayout);
        muestraLayout.setHorizontalGroup(
            muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(muestraLayout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(muestraLayout.createSequentialGroup()
                        .addGap(98, 98, 98)
                        .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(muestraLayout.createSequentialGroup()
                                .addComponent(infoOrdenLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 340, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(135, 135, 135)
                                .addComponent(mesas2))
                            .addGroup(muestraLayout.createSequentialGroup()
                                .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(muestraLayout.createSequentialGroup()
                                        .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(IDProveedorLabel1)
                                            .addComponent(PrecioLabel1))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 53, Short.MAX_VALUE)
                                        .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(PrecioLabel3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 185, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(IDProveedorLabel3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 185, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(muestraLayout.createSequentialGroup()
                                        .addComponent(FechaPLabel1)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(FechaPLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 185, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addGap(44, 44, 44)
                                .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(infoRenglonesLabel1)
                                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 460, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                    .addGroup(muestraLayout.createSequentialGroup()
                        .addGap(9, 9, 9)
                        .addComponent(Titulo2))
                    .addComponent(Separador8))
                .addGap(58, 58, 58))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, muestraLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(volverButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(452, 452, 452))
        );
        muestraLayout.setVerticalGroup(
            muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(muestraLayout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addComponent(Titulo2)
                .addGap(1, 1, 1)
                .addComponent(Separador8)
                .addGap(64, 64, 64)
                .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(muestraLayout.createSequentialGroup()
                        .addGap(57, 57, 57)
                        .addComponent(infoRenglonesLabel1)
                        .addGap(1, 1, 1)
                        .addComponent(FechaPLabel1))
                    .addGroup(muestraLayout.createSequentialGroup()
                        .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(infoOrdenLabel1)
                            .addComponent(mesas2))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(FechaPLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(muestraLayout.createSequentialGroup()
                        .addGap(56, 56, 56)
                        .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(PrecioLabel1)
                            .addComponent(PrecioLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(56, 56, 56)
                        .addGroup(muestraLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(IDProveedorLabel1)
                            .addComponent(IDProveedorLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(muestraLayout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 253, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 54, Short.MAX_VALUE)
                .addComponent(volverButton2)
                .addGap(54, 54, 54))
        );

        mesas.setFont(new java.awt.Font("DialogInput", 1, 28));

        contenedor.add(muestra, "card2");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1065, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(contenedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 619, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(contenedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void aceptarButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_aceptarButton1ActionPerformed

        Map<Orden_Compra, List<Renglon_Compra>> ordenCompleta = new HashMap<>();
        Orden_Compra infoOrden = new Orden_Compra();
        List<Renglon_Compra> infoRenglones = new ArrayList<Renglon_Compra>();
        DefaultTableModel modelo2 = (DefaultTableModel) tablaRenglones.getModel();

        if (tablaInicio.getSelectedRow()==-1){
            JOptionPane.showMessageDialog(this,"Debe seleccionar un renglon","", JOptionPane.WARNING_MESSAGE);
            return;
        }else{

            orden = ordenes.get(tablaInicio.getSelectedRow());
            int id = orden.getId();

            try {
                ordenCompleta = Manager_OrdenCompra.getInstance().consultarOrdenDeCompra(id);

                Set<Orden_Compra> keys = ordenCompleta.keySet();
                for(Orden_Compra key : keys){
                    infoOrden = key;
                }

                infoRenglones = ordenCompleta.get(infoOrden);

                inicio.setVisible(false);
                muestra.setVisible(true);

                FechaPLabel3.setText(infoOrden.getFechaPedido().toString());
                PrecioLabel3.setText(String.valueOf(infoOrden.getPrecioTotal()));
                IDProveedorLabel3.setText(infoOrden.getProveedor());

                for(Renglon_Compra info: infoRenglones){
                    modelo2.addRow(new Object[] {info.getCantidad(), info.getPrecio(), info.getNombre_Tiene()});
                }

            } catch (Exception ex) {
                JOptionPane.showMessageDialog(null, "Sucedió un error inesperado.\n");
            }
        }
    }//GEN-LAST:event_aceptarButton1ActionPerformed

    private void volverButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_volverButton1ActionPerformed
        int eleccion= JOptionPane.showConfirmDialog(null, "¿Está seguro que desea cancelar la operación?", "Confirmar", JOptionPane.CANCEL_OPTION, JOptionPane.QUESTION_MESSAGE);
        if(eleccion==0){
            System.exit(0);
        }
    }//GEN-LAST:event_volverButton1ActionPerformed

    private void volverButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_volverButton2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_volverButton2ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JLabel FechaPLabel1;
    private javax.swing.JLabel FechaPLabel3;
    private javax.swing.JLabel IDProveedorLabel1;
    private javax.swing.JLabel IDProveedorLabel3;
    private javax.swing.JLabel PrecioLabel1;
    private javax.swing.JLabel PrecioLabel3;
    private javax.swing.JLabel Separador7;
    private javax.swing.JLabel Separador8;
    private javax.swing.JLabel Titulo1;
    private javax.swing.JLabel Titulo2;
    private javax.swing.JButton aceptarButton1;
    private javax.swing.JPanel contenedor;
    private javax.swing.JLabel infoOrdenLabel1;
    private javax.swing.JLabel infoRenglonesLabel1;
    private javax.swing.JPanel inicio;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JLabel mesas;
    private javax.swing.JLabel mesas1;
    private javax.swing.JLabel mesas2;
    private javax.swing.JPanel muestra;
    private javax.swing.JTable tablaInicio;
    private javax.swing.JTable tablaRenglones;
    private javax.swing.JButton volverButton1;
    private javax.swing.JButton volverButton2;
    // End of variables declaration//GEN-END:variables
}
